import{c as N,j as e,D as y,g as w,a as v,f as C,i as D}from"./index-B5DDJBRu.js";import{X as S}from"./x-DSv-JPvv.js";import{R as z}from"./refresh-cw-CH6ukssN.js";import{T as I}from"./trash-2-DXibKo_E.js";import{C as P}from"./circle-alert-CU2mbdMD.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],$=N("arrow-left",T);function M({ledgerData:i,user:h,setView:u,handleDeleteSubscription:j,onBack:d}){if(!i)return null;const x=[...(i.subscriptions||[]).filter(t=>{var r;const s=(r=i.projects)==null?void 0:r.find(a=>a.id===t.projectId);return s&&s.type==="private"?s.owner===h.uid:!0})].sort((t,s)=>new Date(t.nextPaymentDate)-new Date(s.nextPaymentDate)),g=t=>{const s=new Date;s.setHours(0,0,0,0);const r=new Date(t);r.setHours(0,0,0,0);const a=r-s,n=Math.ceil(a/(1e3*60*60*24));return n<0?"已過期 (等待自動扣款)":n===0?"今天扣款":n===1?"明天扣款":`${n} 天後`},b=(t,s)=>t==="monthly"?`每月 ${s} 號`:t==="weekly"?"每週":"固定週期";return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col pt-[calc(env(safe-area-inset-top)+1rem)] pb-6 relative animate-in fade-in",children:[e.jsx("div",{className:"px-4 mb-6 flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:d||(()=>u("dashboard")),className:"p-2 -ml-2 bg-white rounded-full shadow-sm border border-gray-100 active:scale-95 transition-transform",children:d?e.jsx($,{size:20,className:"text-gray-500"}):e.jsx(S,{size:20,className:"text-gray-500"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:"固定支出"})]})}),e.jsxs("div",{className:"flex-1 px-4 overflow-y-auto space-y-4",children:[x.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-400",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(z,{size:32,className:"opacity-30"})}),e.jsx("p",{className:"font-bold",children:"目前沒有設定固定支出"}),e.jsx("p",{className:"text-xs mt-2",children:"記帳時開啟「設為固定支出」即可新增"})]}):x.map((t,s)=>{var f,p;const r=((f=t.category)==null?void 0:f.id)||"other",a=(i.customCategories||y).find(l=>l.id===r)||y[0],n=w(a.icon),o=(p=i.projects)==null?void 0:p.find(l=>l.id===t.projectId),m=new Date(t.nextPaymentDate)<new Date,c=v(a,"display");return e.jsxs("div",{className:`bg-white p-5 rounded-2xl shadow-sm border border-gray-100 relative overflow-hidden transition-all ${m?"ring-2 ring-rose-100":""}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center text-xl shadow-sm ${c.containerClass}`,style:c.containerStyle,children:e.jsx(n,{size:24,className:c.iconClass,style:c.iconStyle})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-bold text-gray-800 text-lg line-clamp-1",children:t.name}),e.jsxs("p",{className:"text-xs text-gray-400 flex items-center gap-1 font-medium mt-0.5 truncate",children:[(o==null?void 0:o.name)||"日常開銷"," · ",b(t.cycle,t.payDay)]})]})]}),e.jsx("span",{className:"font-bold text-lg text-gray-800",children:C(t.amount,t.currency||"TWD")})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4 pt-4 border-t border-gray-50",children:[e.jsxs("div",{className:`flex items-center gap-1 text-xs font-bold ${m?"text-rose-500":"text-emerald-500"}`,children:[e.jsx(D,{size:14}),g(t.nextPaymentDate)," (",new Date(t.nextPaymentDate).toLocaleDateString(),")"]}),e.jsxs("button",{onClick:l=>{l.stopPropagation(),confirm(`確定要停止「${t.name}」的自動扣款嗎？`)&&j(t)},className:"flex items-center gap-1 text-xs text-red-500 font-bold hover:bg-red-50 px-3 py-1.5 rounded-lg transition-colors active:scale-95",children:[e.jsx(I,{size:14})," 刪除/停止"]})]})]},s)}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-2xl flex gap-3 items-start mt-6 border border-blue-100",children:[e.jsx(P,{size:20,className:"text-blue-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-xs text-blue-700 leading-relaxed",children:[e.jsx("p",{className:"font-bold mb-1",children:"關於自動記帳"}),e.jsx("p",{children:"系統會在您每次開啟 App 時檢查是否過期，並自動補上交易紀錄。如果您停止訂閱，這裡的紀錄刪除後，未來的自動扣款也會隨之停止。"})]})]})]})]})}export{M as default};
